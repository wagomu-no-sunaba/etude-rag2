{% extends "base.html" %}

{% block content %}
<main>
    <header class="page-header">
        <h1>記事ドラフト生成</h1>
    </header>

    <section class="form-card">
        <form hx-post="/ui/generate/stream" hx-target="#result" hx-swap="innerHTML" id="article-form">
            <!-- 1. 企画の目的 -->
            <div class="form-group">
                <label>企画の目的</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="purpose" value="initial_contact" checked>
                        <span>初期接触</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="purpose" value="nurturing">
                        <span>ナーチャリング</span>
                    </label>
                </div>
            </div>

            <!-- 2. 想定読者（複数選択可） -->
            <div class="form-group">
                <label>想定読者</label>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="executive">
                        <span>経営層</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="marketing">
                        <span>マーケティング部</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="inside_sales">
                        <span>インサイドセールス部</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="sales">
                        <span>営業部</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="system_dev">
                        <span>システム開発部</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="target_reader" value="it_department">
                        <span>情報システム部</span>
                    </label>
                </div>
            </div>

            <!-- 3. 役職 -->
            <div class="form-group">
                <label for="position">役職</label>
                <select name="position" id="position">
                    <option value="">選択してください</option>
                    <option value="executive">経営層・役員相当</option>
                    <option value="director">部長職相当</option>
                    <option value="manager">課長職相当</option>
                    <option value="supervisor">係長・主任職相当</option>
                    <option value="other">その他</option>
                </select>
            </div>

            <!-- 4. 読者の悩み -->
            <div class="form-group">
                <label for="reader_pain">読者の悩み</label>
                <textarea
                    name="reader_pain"
                    id="reader_pain"
                    rows="3"
                    placeholder="読者が抱えている課題や悩みを入力してください"
                ></textarea>
            </div>

            <!-- 5. 読者のゴール -->
            <div class="form-group">
                <label for="reader_goal">読者のゴール</label>
                <textarea
                    name="reader_goal"
                    id="reader_goal"
                    rows="3"
                    placeholder="読者がこの記事を読んで達成したいゴールを入力してください"
                ></textarea>
            </div>

            <!-- 6. コアメッセージ -->
            <div class="form-group">
                <label for="core_message">コアメッセージ</label>
                <textarea
                    name="core_message"
                    id="core_message"
                    rows="3"
                    placeholder="この記事で伝えたい核心的なメッセージを入力してください"
                ></textarea>
            </div>

            <!-- 7. 形式 -->
            <div class="form-group">
                <label>形式</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="format" value="column" checked>
                        <span>コラム</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="format" value="interview">
                        <span>インタビュー</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="format" value="event_report">
                        <span>イベントレポート</span>
                    </label>
                </div>
            </div>

            <!-- 8. CTA -->
            <div class="form-group">
                <label>CTA</label>
                <div class="radio-group radio-group-vertical">
                    <label class="radio-label">
                        <input type="radio" name="cta" value="whitepaper" id="cta-whitepaper">
                        <span>ホワイトペーパー</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="cta" value="service_detail">
                        <span>サービス詳細ページ</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="cta" value="free_consultation">
                        <span>無料相談会</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="cta" value="contact">
                        <span>問い合わせ</span>
                    </label>
                </div>
                <!-- ホワイトペーパーのサブオプション -->
                <div class="conditional-field" id="whitepaper-options" style="display: none;">
                    <label for="whitepaper_type">ホワイトペーパーの種類</label>
                    <select name="whitepaper_type" id="whitepaper_type">
                        <option value="">選択してください</option>
                        <option value="whitepaper_a">○○資料</option>
                        <option value="whitepaper_b">○×資料</option>
                        <option value="whitepaper_c">××資料</option>
                    </select>
                </div>
            </div>

            <!-- 9. 流入チャネル（複数選択可） -->
            <div class="form-group">
                <label>流入チャネル</label>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="search" id="channel-search">
                        <span>検索</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="email">
                        <span>メール</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="sns">
                        <span>SNS</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="referral">
                        <span>リファラル</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="bookmark">
                        <span>ブックマーク</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="channel" value="other">
                        <span>その他</span>
                    </label>
                </div>
            </div>

            <!-- 10. ターゲットキーワード（検索選択時のみ表示） -->
            <div class="form-group conditional-field" id="keyword-field" style="display: none;">
                <label for="target_keyword">ターゲットキーワード</label>
                <input
                    type="text"
                    name="target_keyword"
                    id="target_keyword"
                    placeholder="SEO対象のキーワードを入力してください"
                >
            </div>

            <!-- 11. 文字数 -->
            <div class="form-group">
                <label for="word_count">文字数</label>
                <select name="word_count" id="word_count">
                    <option value="3000">3,000字程度</option>
                    <option value="5000">5,000字程度</option>
                    <option value="7000">7,000字程度</option>
                    <option value="10000">10,000字程度</option>
                    <option value="10000_plus">10,000字以上</option>
                </select>
            </div>

            <button type="submit" class="generate-btn">
                記事を生成
            </button>
        </form>
    </section>

    <div id="result" class="result-container">
        <!-- Generation result will be inserted here -->
    </div>
</main>

<script>
    // CTA: ホワイトペーパー選択時にサブオプションを表示
    document.querySelectorAll('input[name="cta"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const whitepaperOptions = document.getElementById('whitepaper-options');
            if (this.value === 'whitepaper') {
                whitepaperOptions.style.display = 'block';
            } else {
                whitepaperOptions.style.display = 'none';
            }
        });
    });

    // 流入チャネル: 検索選択時にターゲットキーワードを表示
    document.getElementById('channel-search').addEventListener('change', function() {
        const keywordField = document.getElementById('keyword-field');
        if (this.checked) {
            keywordField.style.display = 'block';
        } else {
            keywordField.style.display = 'none';
        }
    });
</script>
{% endblock %}
